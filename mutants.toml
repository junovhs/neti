# SlopChop Mutation Testing Configuration
# =========================================
# This file defines exclusions for cargo-mutants.
#
# Philosophy: Exclude code that hits external system boundaries where
# mutations cannot be caught by unit tests. These require integration
# tests which cargo-mutants doesn't support.
#
# Last updated: 2026-01-22
# Baseline before exclusions: 2475 mutants, 12% kill rate
# Expected after exclusions: ~2100 mutants testable

# -----------------------------------------------------------------------------
# EXCLUDED: External System Boundaries
# -----------------------------------------------------------------------------
# These modules shell out to git, touch the filesystem, or interact with
# OS-level APIs. Mutations here can only be caught by integration tests.

[[exclude]]
# Git shell commands (in_git_repo, current_branch, branch_exists, run_git, etc.)
path = "src/branch.rs"
reason = "All functions shell out to git CLI"

[[exclude]]
# Filesystem + git operations (ensure_gitignore, remove_context_file, commit_changes)
path = "src/clean.rs"
reason = "Filesystem I/O and git shell commands"

[[exclude]]
# OS clipboard APIs (pbcopy, xclip, wl-copy, clip.exe)
path = "src/clipboard/**"
reason = "Platform-specific clipboard system calls"

[[exclude]]
# Terminal rendering with crossterm/ANSI
path = "src/spinner/**"
reason = "Terminal I/O and rendering - visual verification only"

[[exclude]]
# Subprocess execution (cargo test, clippy, etc.)
path = "src/apply/process_runner.rs"
reason = "Spawns and manages external processes"

# -----------------------------------------------------------------------------
# EXCLUDED: CLI/Integration Layer
# -----------------------------------------------------------------------------
# These orchestrate other modules and produce console output.
# Testing them requires end-to-end integration tests.

[[exclude]]
# CLI command handlers - orchestration layer
path = "src/cli/handlers/**"
reason = "CLI orchestration - requires integration tests"

[[exclude]]
# Interactive TUI for config editing
path = "src/cli/config_ui/**"
reason = "Interactive terminal UI"

[[exclude]]
# Console output formatting with colors
path = "src/reporting.rs"
reason = "Display formatting - visual verification"

[[exclude]]
# CLI argument parsing and dispatch
path = "src/cli/dispatch.rs"
reason = "CLI dispatch - integration test territory"

[[exclude]]
# CLI locality handler
path = "src/cli/locality.rs"
reason = "CLI orchestration"

# -----------------------------------------------------------------------------
# EXCLUDED: Scheduled for Deletion
# -----------------------------------------------------------------------------

[[exclude]]
# In-tree mutation testing - being replaced by cargo-mutants
path = "src/mutate/**"
reason = "DEPRECATED: Will be deleted once cargo-mutants workflow is stable"

# -----------------------------------------------------------------------------
# EXCLUDED: Low-Value Display Code
# -----------------------------------------------------------------------------

[[exclude]]
# Apply subsystem console messages
path = "src/apply/messages.rs"
reason = "User-facing message formatting"

[[exclude]]
# Report file generation
path = "src/apply/report_writer.rs"
reason = "Report formatting - visual verification"

[[exclude]]
# Locality report display
path = "src/graph/locality/report.rs"
reason = "Display formatting"

[[exclude]]
# Scan report display
path = "src/cli/handlers/scan_report.rs"
reason = "Display formatting"

# -----------------------------------------------------------------------------
# FUNCTION-LEVEL EXCLUSIONS
# -----------------------------------------------------------------------------
# For modules that are mostly testable but have a few I/O functions

[[exclude]]
# Config file I/O (but NOT Config::from_str or validation logic)
function = "save_to_file"
reason = "Filesystem write"

[[exclude]]
function = "Config::save"
reason = "Filesystem write"

[[exclude]]
# Detection requires filesystem scanning
path = "src/detection.rs"
reason = "Filesystem scanning for build system detection"

# -----------------------------------------------------------------------------
# NOTES FOR FUTURE
# -----------------------------------------------------------------------------
#
# When kill rate reaches 80%, review this file and consider:
# 1. Adding integration test suite that covers excluded modules
# 2. Refactoring I/O-heavy modules to extract pure logic
# 3. Moving some exclusions to "examined and accepted" status
#
# Modules with partial coverage that should NOT be excluded:
# - src/config/mod.rs (extract pure validation logic)
# - src/discovery.rs (extract filter predicates)
# - src/apply/executor.rs (has some pure logic)
